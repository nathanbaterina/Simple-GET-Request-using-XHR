<!-- 

TODO
- Parse the this.responseText variable to JSON format

Author: Jon Bonso
Edited by: Nathan Baterina
Source: www.tutorialsdojo.com

This is just a simple example on how to do a HTTP GET Request using plain old javascript, via XHR, 
without any external library or any other framework. 

With all of the tons of new javascript frameworks out there in the market, the newbies are now getting confused and becoming overly dependent 
with the freshly baked javascript stuff, to the point that they can't even do a simple HTTP call without the use of a javascript framework. 
Sadly, even the experienced IT Professionals also falls into this trap, and missing the essential vanilla javascript skill they need to 
fully comprehend the tools and frameworks they are using. 

Hence, it's good to have this simple example as a refresher. 

-->
<!DOCTYPE html>
<html>
<title>Simple GET Request using XHR </title>
<body>

	<h1>How to invoke a simple GET Request using XHR without ANY fancy JavaScript Framework (React, Vue, Angular etc)</h1>
	<br />
	<h2>Source code: </h2>
	<pre>
function getData() {
  var xhttp = new XMLHttpRequest();
  var targetUrl = "https://api.mcsrvstat.us/2/play.keplermc.xyz";
  
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      document.getElementById("demo").innerHTML =
      this.responseText;
    }else if (this.status){
		document.getElementById("demo").innerHTML = "Can not access: " + targetUrl 
			+ " <br /> Response: " + this.status + " " + this.responseText;
	}else{
		document.getElementById("demo").innerHTML = "Loading... ";
	}
  };
  
  xhttp.open("GET", targetUrl, true);
  xhttp.send();
}
	</pre>

<h2>XHR (XMLHttpRequest) GET Request Example - 6:01 pm</h2>
<button type="button" onclick="getData()">GET Data</button>
<p id="demo"></p>

</body>

<script>
var myminecraftserverdata;
	
function getData() {
  var xhttp = new XMLHttpRequest();
  var targetUrl = "https://api.mcsrvstat.us/2/play.keplermc.xyz";
  
  
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      document.getElementById("demo").innerHTML =
      this.responseText;
      output(JSON.stringify(this.responseText, undefined, 4));
    }else if (this.status){
		document.getElementById("demo").innerHTML = "Can not access: " + targetUrl 
			+ " <br /> Response: " + this.status + " " + this.responseText;
	}else{
		document.getElementById("demo").innerHTML = "Loading... ";
	}
  };
  
  xhttp.open("GET", targetUrl, true);
  xhttp.send();
}

function output(inp) {
    document.body.appendChild(document.createElement('pre')).innerHTML = inp;
}

function syntaxHighlight(json) {
    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
    return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
        var cls = 'number';
        if (/^"/.test(match)) {
            if (/:$/.test(match)) {
                cls = 'key';
            } else {
                cls = 'string';
            }
        } else if (/true|false/.test(match)) {
            cls = 'boolean';
        } else if (/null/.test(match)) {
            cls = 'null';
        }
        return '<span class="' + cls + '">' + match + '</span>';
    });
}

var obj = {a:1, 'b':'foo', c:[false,'false',null, 'null', {d:{e:1.3e5,f:'1.3e5'}}]};
var str = JSON.stringify(myminecraftserverdata, undefined, 4);

output(str);
output(syntaxHighlight(str));
</script>

</html>
